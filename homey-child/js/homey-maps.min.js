!function(f){"use strict";if("undefined"!=typeof HOMEY_map_vars){var h,y=HOMEY_map_vars.user_id,M=f("#listings_found"),E=HOMEY_map_vars.admin_url+"admin-ajax.php",w=HOMEY_map_vars.header_map_city,_=HOMEY_map_vars.markerPricePins,t=HOMEY_map_vars.pin_cluster,o=HOMEY_map_vars.pin_cluster_icon,n=HOMEY_map_vars.pin_cluster_zoom,O=HOMEY_map_vars.is_singular_listing,e=HOMEY_map_vars.homey_default_radius,a=0,H=new Array,Y=f("#homey_halfmap_listings_container"),b=(new google.maps.InfoWindow,HOMEY_map_vars.google_map_style),k=HOMEY_map_vars.default_lat,I=HOMEY_map_vars.default_lng,c=HOMEY_map_vars.arrive,g=HOMEY_map_vars.depart,u=HOMEY_map_vars.guests,v=HOMEY_map_vars.pets,x=HOMEY_map_vars.search_country,z=HOMEY_map_vars.search_city,B=HOMEY_map_vars.search_area,L=HOMEY_map_vars.listing_type,T=HOMEY_map_vars.country,C=HOMEY_map_vars.state,P=HOMEY_map_vars.city,S=HOMEY_map_vars.area,D=HOMEY_map_vars.start_time,R=HOMEY_map_vars.end_time,j=HOMEY_map_vars.min_price,A=HOMEY_map_vars.max_price,Z=HOMEY_map_vars.keyword,N=HOMEY_map_vars.lat,W=HOMEY_map_vars.lng,G=HOMEY_map_vars.radius,U=HOMEY_map_vars.bedrooms,V=HOMEY_map_vars.rooms,F=HOMEY_map_vars.room_size,J=(S=HOMEY_map_vars.area,HOMEY_map_vars.amenity),Q=HOMEY_map_vars.facility,q=HOMEY_map_vars.not_found,i=HOMEY_map_vars.infoboxClose,K=HOMEY_map_vars.bedrooms_icon,X=HOMEY_map_vars.bathroom_icon,$=HOMEY_map_vars.guests_icon,ee=f("#securityhomeyMap").val(),ae=0,te=HOMEY_ajax_vars.compare_url,oe=HOMEY_ajax_vars.add_compare,ne=HOMEY_ajax_vars.remove_compare,ie=HOMEY_ajax_vars.compare_limit,se=!1;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(se=!0),""!=b)b=JSON.parse(b);if("yes"==_)var s=-30;else s=-70;var re=new InfoBox({maxWidth:300,alignBottom:!0,disableAutoPan:!1,pixelOffset:new google.maps.Size(-160,s),zIndex:null,boxClass:"homeyInfobox",closeBoxMargin:"13px 2px -14px 2px",closeBoxURL:i,infoBoxClearance:new google.maps.Size(20,20),pane:"floatPane",enableEventPropagation:!1}),le=function(e){if("yes"==t){var a=16;(n=parseInt(n))&&(a=n),new MarkerClusterer(e,H,{maxZoom:a,gridSize:60,styles:[{url:o,width:48,height:48,textColor:"#fff"}]})}},me=function(a){google.maps.event.addDomListener(document.getElementById("listing-mapzoomin"),"click",function(){var e=parseInt(a.getZoom(),10);console.log(e),20<++e&&(e=20),console.log("== "+e+" ++"),a.setZoom(e)})},pe=function(a){google.maps.event.addDomListener(document.getElementById("listing-mapzoomout"),"click",function(){var e=parseInt(a.getZoom(),10);console.log(e),--e<0&&(e=0),console.log("== "+e+" -- "),a.setZoom(e)})};f(".homeyMapType").on("click",function(e){e.preventDefault();var a,t=f(this).data("maptype");"roadmap"===(a=t)?h.setMapTypeId(google.maps.MapTypeId.ROADMAP):"satellite"===a?h.setMapTypeId(google.maps.MapTypeId.SATELLITE):"hybrid"===a?h.setMapTypeId(google.maps.MapTypeId.HYBRID):"terrain"===a&&h.setMapTypeId(google.maps.MapTypeId.TERRAIN)});f("#homey-gmap-next").on("click",function(){!function(){for(++a>H.length&&(a=1);!1===H[a-1].visible;)++a>H.length&&(a=1);console.log(a-1),google.maps.event.trigger(H[a-1],"click")}()}),f("#homey-gmap-prev").on("click",function(){!function(){for(--a<1&&(a=H.length);!1===H[a-1].visible;)--a>H.length&&(a=1);console.log(a-1),google.maps.event.trigger(H[a-1],"click")}()});var de=function(e,o){var a=new google.maps.places.SearchBox(e);o.controls[google.maps.ControlPosition.TOP_LEFT].push(e),o.addListener("bounds_changed",function(){a.setBounds(o.getBounds())});var n=[];a.addListener("places_changed",function(){var e=a.getPlaces();if(0!=e.length){n.forEach(function(e){e.setMap(null)}),n=[];var t=new google.maps.LatLngBounds;e.forEach(function(e){var a={url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};n.push(new google.maps.Marker({map:o,icon:a,title:e.name,position:e.geometry.location})),e.geometry.viewport?t.union(e.geometry.viewport):t.extend(e.geometry.location)}),o.fitBounds(t)}})},ce=function(){for(var e=0;e<H.length;e++)H[e].setMap(null);H=[]},ge=function(e,u){f.each(e,function(e,a){var t=new google.maps.LatLng(a.lat,a.long),o=a.data?a.data.post_title:a.title;if("yes"==_)var n='<div data-id="'+a.id+'" class="gm-marker gm-marker-color-'+a.term_id+'"><div class="gm-marker-price">'+a.price+"</div></div>",i=new RichMarker({map:u,position:t,draggable:!1,flat:!0,anchor:RichMarkerPosition.MIDDLE,content:n});else{var s=a.icon,r=new google.maps.Size(44,56);1.5<window.devicePixelRatio&&a.retinaIcon&&(s=a.retinaIcon,r=new google.maps.Size(44,56));var l={url:s,size:r,scaledSize:new google.maps.Size(44,56)};i=new google.maps.Marker({position:t,map:u,icon:l,draggable:!1,title:o})}var m="",p="",d="",c="";""!=a.bedrooms&&(m="<li>"+K+'<span class="total-beds">'+a.bedrooms+"</span></li>"),""!=a.baths&&(p="<li>"+X+'<span class="total-baths">'+a.baths+"</span></li>"),""!=a.guests&&(d="<li>"+$+'<span class="total-guests">'+a.guests+"</span></li>"),""!=a.listing_type&&(c='<li class="item-type">'+a.listing_type+"</li>");var g='<div id="google-maps-info-window"><div class="item-wrap item-grid-view"><div class="media property-item"><div class="media-left"><div class="item-media item-media-thumb"><a href="'+a.url+'" class="hover-effect" target="_blank">'+a.thumbnail+'</a><div class="item-media-price"><span class="item-price">'+a.price+'</span></div></div></div><div class="media-body item-body clearfix"><div class="item-title-head"><div class="title-head-left"><h2 class="title"><a href="'+a.url+'"  target="_blank">'+o+'</a></h2><address class="item-address">'+a.address+'</address></div></div><ul class="item-amenities">'+m+p+d+c+"</ul></div></div></div></div>";google.maps.event.addListener(i,"click",function(e){re.setContent(g),re.open(u,this)}),H.push(i)})},ue=function(e,a,t,o,n,i,s,r,l,m){if(null!=document.getElementById(t)){if(i=i||14,!s)s=0;var p,d="";if(r?p="homey_half_map":(p="homey_header_map","lat_long"==m||"city"==m&&(d=w)),h=new google.maps.Map(document.getElementById(t),{zoom:i,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,overviewMapControl:!1,scrollwheel:!1,fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},center:new google.maps.LatLng(e,a),mapTypeId:"roadmap",gestureHandling:"cooperative",styles:b}),r)var c=l;else c={action:p,map_cities:d,security:ee};google.maps.event.addListenerOnce(h,"idle",function(){u(E,c),g()});var g=function(){1==s&&google.maps.event.addListener(h,"dragend",function(){var e={action:p,map_cities:d,security:ee,optimized_loading:1,north_east_lat:h.getBounds().getNorthEast().lat(),north_east_lng:h.getBounds().getNorthEast().lng(),south_west_lat:h.getBounds().getSouthWest().lat(),south_west_lng:h.getBounds().getSouthWest().lng()};u(E,e)})},u=function(t,e){f.ajax({url:t,dataType:"json",method:"POST",data:e,beforeSend:function(){f("#homey-map-loading").show(),r&&Y.empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(e){var a;!0===e.getListings?(ce(),ge(e.listings,h),r&&(Y.empty().html(e.listingHtml),M.empty().html(e.total_results),se||f(".infobox_trigger").each(function(e){f(this).on("mouseenter",function(){google.maps.event.trigger(H[e],"click")}),f(this).on("mouseleave",function(){re.open(null,null)})})),s||_(),le(h),homey_init_add_favorite(t,y,O),homey_init_remove_favorite(t,y,O),a=homeyGetCookie("homey_compare_listings"),add_to_compare(te,oe,ne,ie,a,4),remove_from_compare(a,oe,ne),r&&(ye(),f(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")),f("#homey-map-loading").hide()):(ce(),h.setCenter(new google.maps.LatLng(k,I)),f("#homey-halfmap").append('<div class="map-notfound">'+q+"</div>"),Y.empty().html('<div class="map-notfound">'+q+"</div>"),M.empty().html(e.total_results))},error:function(e){console.log(e)}})},_=function(){h.fitBounds(H.reduce(function(e,a){return e.extend(a.getPosition())},new google.maps.LatLngBounds));var e=parseInt(h.getZoom(),10);20<e&&(e=14),h.setZoom(e)};if(document.getElementById("listing-mapzoomin")&&me(h),document.getElementById("listing-mapzoomout")&&pe(h),document.getElementById("google-map-search")){var v=document.getElementById("google-map-search");de(v,h)}}else console.log("No map element found")},r=function(e,a,t,o,n,i,s,r,l,m){var p=f("#homey-halfmap");c=e.find('input[name="arrive"]').val(),g=e.find('input[name="depart"]').val(),u=e.find('input[name="guest"]').val(),Z=e.find('input[name="keyword"]').val(),v=e.find('input[name="pets"]:checked').val(),B=e.find('input[name="search_area"]').val(),z=e.find('input[name="search_city"]').val(),x=e.find('input[name="search_country"]').val(),N=e.find('input[name="lat"]').val(),W=e.find('input[name="lng"]').val(),G=e.find('input[name="radius"]').val(),L=e.find('select[name="listing_type"]').val(),T=e.find('select[name="country"]').val(),C=e.find('select[name="state"]').val(),P=e.find('select[name="city"]').val(),S=e.find('select[name="area"]').val(),D=e.find('select[name="start"]').val(),R=e.find('select[name="end"]').val(),""!=L&&null!=L||(L=p.data("type")),J=e.find(".amenities-list input[type=checkbox]:checked").map(function(e,a){return f(a).val()}).toArray(),Q=e.find(".facilities-list input[type=checkbox]:checked").map(function(e,a){return f(a).val()}).toArray(),j=e.find('select[name="min-price"]').val(),A=e.find('select[name="max-price"]').val(),U=e.find('select[name="bedrooms"]').val(),V=e.find('select[name="rooms"]').val(),F=e.find('select[name="room_size"]').val();var d=f("#sort_listings_halfmap").val();null!=a&&(ae=a);ue(t,o,n,0,0,r,l,m,{action:"homey_half_map",arrive:c,depart:g,guest:u,keyword:Z,pets:v,bedrooms:U,rooms:V,room_size:F,search_country:x,search_city:z,search_area:B,listing_type:L,"min-price":j,"max-price":A,country:T,search_lat:N,search_lng:W,radius:G,state:C,city:P,area:S,start_hour:D,end_hour:R,amenity:J,facility:Q,sort_by:d,layout:_e,num_posts:ve,paged:a,security:ee},"")};if(0<f("#banner-map").length){var l=(be=f("#banner-map")).data("zoomlevel"),m=be.data("maptype");be.data("lat"),be.data("long");ue(Oe="",He="",ke="banner-map",0,0,Ie=l,he=0,fe=!1,null,m)}if(0<f("#homey-halfmap").length){l=(be=f("#homey-halfmap")).data("zoom");var _e=be.data("layout"),ve=be.data("num-posts"),p=be.data("order"),d=be.data("type");""==L&&(L=d);var fe,he;ue(Oe="",He="",ke="homey-halfmap",0,0,Ie=l,he=0,fe=!0,{action:"homey_half_map",arrive:c,depart:g,guest:u,keyword:Z,pets:v,bedrooms:U,rooms:V,room_size:F,search_country:x,search_city:z,search_area:B,listing_type:L,"min-price":j,"max-price":A,country:T,state:C,city:P,area:S,search_lat:N,search_lng:W,radius:G,start_hour:D,end_hour:R,amenity:J,facility:Q,layout:_e,num_posts:ve,sort_by:p,paged:ae,security:ee},m=""),f(".homey_half_map_search_btn").on("click",function(e){e.preventDefault();var a=f(this).parents(".half-map-wrap");r(a,1,Oe,He,ke,0,0,Ie,he,fe)}),f("#sort_listings_halfmap").on("change",function(e){e.preventDefault();var a=f(this).parents(".half-map-wrap");r(a,1,Oe,He,ke,0,0,Ie,he,fe)});var ye=function(){return f(".half_map_ajax_pagi a").on("click",function(e){e.preventDefault();var a=f(this).data("homeypagi"),t=f(this).parents(".half-map-wrap");r(t,a,Oe,He,ke,0,0,Ie,he,fe)}),!1};0<f("#radius-range-slider").length&&(ze=e,f("#radius-range-slider").slider({value:ze,min:0,max:100,step:1,slide:function(e,a){f("#radius-range-text").html(a.value),f("#radius-range-value").val(a.value)},stop:function(e,a){var t=f(this).parents(".half-map-wrap");r(t,1,Oe,He,ke,0,0,Ie,he,fe)}}),f("#radius-range-text").html(f("#radius-range-slider").slider("value")),f("#radius-range-value").val(f("#radius-range-slider").slider("value")))}if(0<f("#homey-single-map").length){l=(be=f("#homey-single-map")).data("zoom");var Me=be.data("pin-type"),Ee=be.data("marker-pin"),we=be.data("marker-pin-retina"),Oe=be.data("lat"),He=be.data("long");if("marker"==Me)var Ye=!1;else Ye=!0;!function(e,a,t,o,n,i,s){var r;o=o||!1,n=n||15;r=new google.maps.LatLng(e,a);var l,m,p;m={zoom:n,center:r,disableDefaultUI:!1,gestureHandling:"cooperative",styles:b},p=document.getElementById(t),h=new google.maps.Map(p,m),o||function(e){var a=i,t=new google.maps.Size(44,56);1.5<window.devicePixelRatio&&s&&(a=s,t=new google.maps.Size(44,56));var o={url:a,size:t,scaledSize:new google.maps.Size(44,56)};new google.maps.Marker({position:e.getCenter(),map:e,icon:o,draggable:!1,animation:google.maps.Animation.DROP})}(h),o&&(l=h,new google.maps.Circle({strokeColor:"#4f5962",strokeOpacity:.8,strokeWeight:2,fillColor:"#4f5962",fillOpacity:.35,map:l,center:r,radius:500}))}(Oe,He,ke="homey-single-map",Ye,Ie=l,Ee,we)}if(0<f("#homey_sticky_map").length){var be=f("#homey_sticky_map"),ke="homey_sticky_map",Ie=12,xe=be.data("mappaged");!function(e,a,t){if(null!=document.getElementById(e)){a=a||14;h=new google.maps.Map(document.getElementById(e),{zoom:a,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,overviewMapControl:!1,scrollwheel:!1,fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},center:new google.maps.LatLng("",""),mapTypeId:"roadmap",gestureHandling:"cooperative",styles:b});var o={action:"homey_sticky_map",paged:t,security:ee};google.maps.event.addListenerOnce(h,"idle",function(){n(E,o)});var n=function(e,a){f.ajax({url:e,dataType:"json",method:"POST",data:a,success:function(e){!0===e.getListings&&(ce(),ge(e.listings,h),i(),le(h),f("#homey-map-loading").hide())},error:function(e){console.log(e)}})},i=function(){h.fitBounds(H.reduce(function(e,a){return e.extend(a.getPosition())},new google.maps.LatLngBounds))};if(document.getElementById("listing-mapzoomin")&&me(h),document.getElementById("listing-mapzoomout")&&pe(h),document.getElementById("google-map-search")){var s=document.getElementById("google-map-search");de(s,h)}}else console.log("No map element found")}(ke,Ie,xe)}f("#homey-gmap-full").on("click",function(){f('div.gm-style button[title="Toggle fullscreen view"]').trigger("click")})}var ze}(jQuery);